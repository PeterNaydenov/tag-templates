!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).tagTemplates=e()}(this,(function(){"use strict";function t(t){this.settings.debug&&console.error(t)}const e={TG_PRX:"{{",TG_SFX:"}}",TG_SIZE_P:2,TG_SIZE_S:2,DV:":",debug:!1};function n(t){return t.includes("\n")?t.trim().split("\n"):t.trim().split(" ")}function i(t,e){const n={};return t.join(" ").trim().replace(/(\s{3,})/gim,"|||").split("|||").forEach(((t,i)=>{let[r,l]=t.split(e);r=r.trim(),l=l.trim(),n[r]||(n[r]=l)})),n}function r(r,l){r.TG_PRX&&(r.TG_SIZE_P=r.TG_PRX.length),r.TG_SFX&&(r.TG_SIZE_S=r.TG_SFX.length);let s={...e,...r};return this.settings=s,this.addTemplate=function(t){return function(){let e=null,n=[],i=1,r=null;for(let t of arguments[0])""===t.replace(/^\n+|\n$/g,"").trim()&&(t=arguments[i],i++),e||(t=t.replace(/^\n+|\n$/g,"").trim(),r=t.split(" "),e=r.shift().trim()),!r&&t&&(r=t.split(" ")),n=n.concat(r),r=null;t[e]=this._chopTemplate(n.join(" ").trim())}}(l),this.showTemplateNames=function(t){return function(){return Object.keys(t)}}(l),this.render=function(t,e){return function(){let r=this,{TG_PRX:l,TG_SIZE_P:s,TG_SIZE_S:u,DV:o}=e,f=null,c=1,a=null,d={};for(let t of arguments[0])if(""===t.replace(/^\n+|\n$/g,"").trim()&&arguments[c]&&(t=arguments[c].trim(),c++),f)t&&n(t).map((t=>{t.match(/:$/)?(d[t.slice(0,-1).trim()]=arguments[c].trim(),c++):t&&(d=Object.assign({},i([t],o),d))}));else{t=t.replace(/^\n+|\n$/g,"").trim(),a=t.split(" "),f=a.shift().trim();let e=a.join(" ").trim();e.match(/:$/)?(d[e.slice(0,-1).trim()]=arguments[c].trim(),c++):d=Object.assign({},i(a,o),d)}return t.hasOwnProperty(f)?t[f].map((t=>{let e=t.indexOf(l),n=t.length;if(-1!=e){let e=t.substr(s,n-s-u);return d[e]?d[e]:void r._debugger(`Missing data for placeholder "${e}"`)}return t})).join(""):(r._debugger(`Missing template "${f}"`),null)}}(l,s),this.dataRender=function(t,e){return function(n,i){let r=this,{TG_PRX:l,TG_SIZE_P:s,TG_SIZE_S:u}=e;return t.hasOwnProperty(n)?t[n].map((t=>{let e=t.indexOf(l),n=t.length;if(-1!=e){let e=t.substr(s,n-s-u);return i[e]?i[e]:void r._debugger(`Missing data for placeholder "${e}"`)}return t})).join(""):(r._debugger(`Missing template "${n}"`),null)}}(l,s),this._chopTemplate=function(t){return function e(n){const{TG_PRX:i,TG_SFX:r,TG_SIZE_P:l,TG_SIZE_S:s}=t;let u,o,f,c=[];if("string"!=typeof n)return[void 0];if(0==n.length)return[];if(u=n.indexOf(i),0<u&&c.push(n.slice(0,u)),-1==u)return c.push(n),c;{if(f=n.indexOf(i,u+l),o=n.indexOf(r),-1==o)return[void 0];if(o<u)return[void 0];if(o+=s,-1!=f&&f<o)return[void 0];c.push(n.slice(u,o));let t=e(n.slice(o));return c.concat(t)}}}(s),this._debugger=t,this}return function(t={}){return new r(t,{})}}));
